<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="QFramework RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="QFramework Atom Feed"><title data-react-helmet="true">7. å±‚çº§çš„è®¿é—®è§„åˆ™ã€BindablePropertyã€ä¾èµ–å€’ç½®åŸåˆ™ã€Query | QFramework</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="http://doc.qframework.cn/docs/quick-start/rules_bindableproperty_dip"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="7. å±‚çº§çš„è®¿é—®è§„åˆ™ã€BindablePropertyã€ä¾èµ–å€’ç½®åŸåˆ™ã€Query | QFramework"><meta data-react-helmet="true" name="description" content="åœ¨ä¸Šä¸€ç¯‡ï¼Œæˆ‘ä»¬æ¥è§¦åˆ°äº† QFramework æ‰€æä¾›çš„å…¨éƒ¨å±‚çº§ï¼Œå¦‚ä¸‹:"><meta data-react-helmet="true" property="og:description" content="åœ¨ä¸Šä¸€ç¯‡ï¼Œæˆ‘ä»¬æ¥è§¦åˆ°äº† QFramework æ‰€æä¾›çš„å…¨éƒ¨å±‚çº§ï¼Œå¦‚ä¸‹:"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="http://doc.qframework.cn/docs/quick-start/rules_bindableproperty_dip"><link data-react-helmet="true" rel="alternate" href="http://doc.qframework.cn/docs/quick-start/rules_bindableproperty_dip" hreflang="en"><link data-react-helmet="true" rel="alternate" href="http://doc.qframework.cn/docs/quick-start/rules_bindableproperty_dip" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d9d837ef.css">
<link rel="preload" href="/assets/js/runtime~main.0f8f5c73.js" as="script">
<link rel="preload" href="/assets/js/main.9af385a4.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/LOGO.png" alt="QFramework Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/LOGO.png" alt="QFramework Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">QFramework</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/blog">åšå®¢</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/liangxiegame/qframework" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://gitee.com/liangxiegame/QFramework" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ğŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ğŸŒ</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">README.md</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/quick-start/intro">å…¥é—¨æ•™ç¨‹</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start/intro">1. æ¦‚è¿°</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start/mvc_intro">2. MVC å¿«é€Ÿå…¥é—¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start/command">3. å¼•å…¥ Command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start/event">4. å¼•å…¥ Event</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start/utility">5. å¼•å…¥ Utility</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start/system">6. å¼•å…¥ System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/quick-start/rules_bindableproperty_dip">7. å±‚çº§çš„è®¿é—®è§„åˆ™ã€BindablePropertyã€ä¾èµ–å€’ç½®åŸåˆ™ã€Query</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/more/framework_design">æ›´å¤šå†…å®¹</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="theme-doc-markdown markdown"><header><h1>7. å±‚çº§çš„è®¿é—®è§„åˆ™ã€BindablePropertyã€ä¾èµ–å€’ç½®åŸåˆ™ã€Query</h1></header><p>åœ¨ä¸Šä¸€ç¯‡ï¼Œæˆ‘ä»¬æ¥è§¦åˆ°äº† QFramework æ‰€æä¾›çš„å…¨éƒ¨å±‚çº§ï¼Œå¦‚ä¸‹:</p><ul><li>è¡¨ç°å±‚ï¼šIController</li><li>ç³»ç»Ÿå±‚ï¼šISystem</li><li>æ•°æ®å±‚ï¼šIModel</li><li>å·¥å…·å±‚ï¼šIUtility</li></ul><p>è¿™é‡Œæœ‰ä¸€ä»½å±‚çº§çš„è§„åˆ™ï¼Œå¦‚ä¸‹ï¼š</p><ul><li>è¡¨ç°å±‚ï¼šViewControllerå±‚ã€‚IControlleræ¥å£ï¼Œè´Ÿè´£æ¥æ”¶è¾“å…¥å’ŒçŠ¶æ€å˜åŒ–æ—¶çš„è¡¨ç°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒMonoBehaviour å‡ä¸ºè¡¨ç°å±‚<ul><li>å¯ä»¥è·å–System</li><li>å¯ä»¥è·å–Model</li><li>å¯ä»¥å‘é€Command</li><li>å¯ä»¥ç›‘å¬Event</li></ul></li><li>ç³»ç»Ÿå±‚ï¼šSystemå±‚ã€‚ISystemæ¥å£ï¼Œå¸®åŠ©IControlleræ‰¿æ‹…ä¸€éƒ¨åˆ†é€»è¾‘ï¼Œåœ¨å¤šä¸ªè¡¨ç°å±‚å…±äº«çš„é€»è¾‘ï¼Œæ¯”å¦‚è®¡æ—¶ç³»ç»Ÿã€å•†åŸç³»ç»Ÿã€æˆå°±ç³»ç»Ÿç­‰<ul><li>å¯ä»¥è·å–System</li><li>å¯ä»¥è·å–Model</li><li>å¯ä»¥ç›‘å¬Event</li><li>å¯ä»¥å‘é€Event</li></ul></li><li>æ•°æ®å±‚ï¼šModelå±‚ã€‚IModelæ¥å£ï¼Œè´Ÿè´£æ•°æ®çš„å®šä¹‰ã€æ•°æ®çš„å¢åˆ æŸ¥æ”¹æ–¹æ³•çš„æä¾›<ul><li>å¯ä»¥è·å–Utility</li><li>å¯ä»¥å‘é€Event</li></ul></li><li>å·¥å…·å±‚ï¼šUtilityå±‚ã€‚IUtilityæ¥å£ï¼Œè´Ÿè´£æä¾›åŸºç¡€è®¾æ–½ï¼Œæ¯”å¦‚å­˜å‚¨æ–¹æ³•ã€åºåˆ—åŒ–æ–¹æ³•ã€ç½‘ç»œè¿æ¥æ–¹æ³•ã€è“ç‰™æ–¹æ³•ã€SDKã€æ¡†æ¶ç»§æ‰¿ç­‰ã€‚å•¥éƒ½å¹²ä¸äº†ï¼Œå¯ä»¥é›†æˆç¬¬ä¸‰æ–¹åº“ï¼Œæˆ–è€…å°è£…API</li><li>é™¤äº†å››ä¸ªå±‚çº§ï¼Œè¿˜æœ‰ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µâ€”â€”Command<ul><li>å¯ä»¥è·å–System</li><li>å¯ä»¥è·å–Model</li><li>å¯ä»¥å‘é€Event</li><li>å¯ä»¥å‘é€Command</li></ul></li><li>å±‚çº§è§„åˆ™ï¼š<ul><li>IController æ›´æ”¹ ISystemã€IModel çš„çŠ¶æ€å¿…é¡»ç”¨Command</li><li>ISystemã€IModelçŠ¶æ€å‘ç”Ÿå˜æ›´åé€šçŸ¥IControllerå¿…é¡»ç”¨äº‹ä»¶æˆ–BindableProperty</li><li>IControllerå¯ä»¥è·å–ISystemã€IModelå¯¹è±¡æ¥è¿›è¡Œæ•°æ®æŸ¥è¯¢</li><li>ICommandä¸èƒ½æœ‰çŠ¶æ€</li><li>ä¸Šå±‚å¯ä»¥ç›´æ¥è·å–ä¸‹å±‚ï¼Œä¸‹å±‚ä¸èƒ½è·å–ä¸Šå±‚å¯¹è±¡</li><li>ä¸‹å±‚å‘ä¸Šå±‚é€šä¿¡ç”¨äº‹ä»¶</li><li>ä¸Šå±‚å‘ä¸‹å±‚é€šä¿¡ç”¨æ–¹æ³•è°ƒç”¨ï¼ˆåªæ˜¯åšæŸ¥è¯¢ï¼ŒçŠ¶æ€å˜æ›´ç”¨Commandï¼‰ï¼ŒIControllerçš„äº¤äº’é€»è¾‘ä¸ºç‰¹åˆ«æƒ…å†µï¼Œåªèƒ½ç”¨Command</li></ul></li></ul><p>è¿™é‡Œæœ‰ä¸€äº›å†…å®¹ï¼Œæˆ‘ä»¬æ²¡æœ‰æ¥è§¦åˆ°ï¼Œæ¯”å¦‚ BindableProperty ä»¥åŠè¿™äº›å±‚çº§éƒ½æ˜¯æ¥å£ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åœ¨è¿™ä¸€ç¯‡åšä¸€ä¸ªè¡¥å……ã€‚</p><p>é¦–å…ˆæ˜¯ BindablePropertyï¼Œå…¶å®éå¸¸ç®€å•ï¼Œå°±æ˜¯ æ•°æ® + äº‹ä»¶ çš„ä¸€ä¸ªç»“åˆä½“ã€‚</p><p>å½“ BindableProperty çš„æ•°å€¼å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šåƒå¤–å‘é€ä¸€ä¸ªæ•°æ®å˜æ›´äº‹ä»¶ï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_J+bg language-csharp theme-code-block"><div class="codeBlockContent_csEI csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine.UI;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace QFramework.Example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å®šä¹‰ä¸€ä¸ª Model å¯¹è±¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class CounterAppModel : AbstractModel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public BindableProperty&lt;int&gt; Count = new BindableProperty&lt;int&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protected override void OnInit()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // è®¾ç½®å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Count.Value = this.GetUtility&lt;Storage&gt;().LoadInt(nameof(Count));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ç›‘å¬æ•°æ®å˜æ›´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Count.Register(count =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                this.GetUtility&lt;Storage&gt;().SaveInt(nameof(Count), count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class AchievementSystem : AbstractSystem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protected override void OnInit()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var model = this.GetModel&lt;CounterAppModel&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ç›‘å¬æ•°æ®å˜æ›´äº‹ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            model.Count.Register(count =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (count == 10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Debug.Log(&quot;è§¦å‘ ç‚¹å‡»è¾¾äºº æˆå°±&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else if (count == 20)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Debug.Log(&quot;è§¦å‘ ç‚¹å‡»ä¸“å®¶ æˆå°±&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else if (count == -10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Debug.Log(&quot;è§¦å‘ ç‚¹å‡»èœé¸Ÿ æˆå°±&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å®šä¹‰å­˜å‚¨ Utility å±‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class Storage : IUtility</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void SaveInt(string key, int value)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PlayerPrefs.SetInt(key,value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public int LoadInt(string key, int defaultValue = 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return PlayerPrefs.GetInt(key, defaultValue);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å®šä¹‰ä¸€ä¸ªæ¶æ„ï¼ˆç”¨äºç®¡ç†æ¨¡å—ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class CounterApp : Architecture&lt;CounterApp&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protected override void Init()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // æ³¨å†Œæˆå°±ç³»ç»Ÿ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.RegisterSystem(new AchievementSystem());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.RegisterModel(new CounterAppModel());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // æ³¨å†Œå­˜å‚¨å·¥å…·å¯¹è±¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.RegisterUtility(new Storage());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å®šä¹‰æ•°æ®å˜æ›´äº‹ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public struct CountChangeEvent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å¼•å…¥ Command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class IncreaseCountCommand : AbstractCommand</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protected override void OnExecute()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.GetModel&lt;CounterAppModel&gt;().Count.Value++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class DecreaseCountCommand : AbstractCommand</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protected override void OnExecute()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.GetModel&lt;CounterAppModel&gt;().Count.Value--;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class CounterAppController : MonoBehaviour,IController // å®ç° IController æ¥å£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // View</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private Button mBtnAdd;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private Button mBtnSub;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private Text mCountText;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private CounterAppModel Model;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private void Start()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // è·å–æ¨¡å‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Model = this.GetModel&lt;CounterAppModel&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ç»„ä»¶è·å–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mBtnAdd = transform.Find(&quot;BtnAdd&quot;).GetComponent&lt;Button&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mBtnSub = transform.Find(&quot;BtnSub&quot;).GetComponent&lt;Button&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mCountText = transform.Find(&quot;CountText&quot;).GetComponent&lt;Text&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ç›‘å¬è¾“å…¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mBtnAdd.onClick.AddListener(() =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // äº¤äº’é€»è¾‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                this.SendCommand&lt;IncreaseCountCommand&gt;(); // æ²¡æœ‰å‚æ•°æ„é€ çš„å‘½ä»¤æ”¯æŒæ³›å‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mBtnSub.onClick.AddListener(() =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // äº¤äº’é€»è¾‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                this.SendCommand(new DecreaseCountCommand()); // ä¹Ÿæ”¯æŒç›´æ¥ä¼ å…¥å¯¹è±¡ï¼ˆæ–¹ä¾¿é€šè¿‡æ„é€ ä¼ å‚)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // æ•°æ®å˜æ›´äº‹ä»¶ç›‘å¬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Model.Count.RegisterWithInitValue(count =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                mCountText.text = count.ToString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }).UnRegisterWhenGameObjectDestroyed(gameObject);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// æŒ‡å®šæ¶æ„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public IArchitecture GetArchitecture()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return CounterApp.Interface;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>ä½¿ç”¨ BindableProperty å¯ä»¥èŠ‚çœå¤§é‡çš„ä»£ç ã€‚</p><p>BindableProperty çš„å¼•å…¥ä»…ä»…æ˜¯ä¸ºäº†å¯¹ä»£ç é‡åšä¼˜åŒ–ï¼Œæ–¹ä¾¿å¤§å®¶ä½¿ç”¨ã€‚</p><p>ä½†æ˜¯ BIndableProperty å¹¶ä¸èƒ½å®Œå…¨æ›¿ä»£äº‹ä»¶æœºåˆ¶ï¼Œæ¯”å¦‚æ•°ç»„çš„å˜æ›´æˆ–è€…æ˜¯ä¸€äº›å…¶ä»–çš„é€šçŸ¥äº‹ä»¶è¿˜æ˜¯éœ€è¦ç”¨äº‹ä»¶æœºåˆ¶ã€‚</p><p>BindableProperty çš„ç”¨æ³•å°±ä»‹ç»åˆ°è¿™é‡Œã€‚</p><p>æ¥ç€ä»‹ç»é¢å‘æ¥å£çš„æ¨¡å—æœºåˆ¶ï¼Œå³ QFramework æœ¬èº«æ”¯æŒä¾èµ–å€’ç½®åŸåˆ™çš„ï¼Œæ‰€æœ‰çš„æ¨¡å—è®¿é—®äº¤äº’éƒ½å¯ä»¥é€šè¿‡æ¥å£æ¥å®Œæˆï¼Œä»£ç å¦‚ä¸‹:</p><div class="codeBlockContainer_J+bg language-csharp theme-code-block"><div class="codeBlockContent_csEI csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine.UI;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace QFramework.Example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å®šä¹‰æ¥å£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public interface ICounterAppModel : IModel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BindableProperty&lt;int&gt; Count { get; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å®šä¹‰ä¸€ä¸ª Model å¯¹è±¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class CounterAppModel : AbstractModel,ICounterAppModel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // æ•°æ®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public BindableProperty&lt;int&gt; Count { get; } = new BindableProperty&lt;int&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protected override void OnInit()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // è®¾ç½®å€¼ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // é€šè¿‡æ¥å£è®¿é—®</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Count.Value = this.GetUtility&lt;IStorage&gt;().LoadInt(nameof(Count));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ç›‘å¬æ•°æ®å˜æ›´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Count.Register(count =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                this.GetUtility&lt;IStorage&gt;().SaveInt(nameof(Count), count);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public interface IAchievementSystem : ISystem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class AchievementSystem : AbstractSystem,IAchievementSystem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protected override void OnInit()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            var model = this.GetModel&lt;ICounterAppModel&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ç›‘å¬æ•°æ®å˜æ›´äº‹ä»¶</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            model.Count.Register(count =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (count == 10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Debug.Log(&quot;è§¦å‘ ç‚¹å‡»è¾¾äºº æˆå°±&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else if (count == 20)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Debug.Log(&quot;è§¦å‘ ç‚¹å‡»ä¸“å®¶ æˆå°±&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                else if (count == -10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Debug.Log(&quot;è§¦å‘ ç‚¹å‡»èœé¸Ÿ æˆå°±&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public interface IStorage : IUtility</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        void SaveInt(string key, int value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int LoadInt(string key, int defaultValue = 0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å®šä¹‰å­˜å‚¨ Utility å±‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class Storage : IStorage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void SaveInt(string key, int value)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            PlayerPrefs.SetInt(key,value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public int LoadInt(string key, int defaultValue = 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return PlayerPrefs.GetInt(key, defaultValue);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å®šä¹‰ä¸€ä¸ªæ¶æ„ï¼ˆç”¨äºç®¡ç†æ¨¡å—ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class CounterApp : Architecture&lt;CounterApp&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protected override void Init()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // æ³¨å†Œæˆå°±ç³»ç»Ÿ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.RegisterSystem&lt;IAchievementSystem&gt;(new AchievementSystem());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.RegisterModel&lt;ICounterAppModel&gt;(new CounterAppModel());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // æ³¨å†Œå­˜å‚¨å·¥å…·å¯¹è±¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.RegisterUtility&lt;IStorage&gt;(new Storage());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // å¼•å…¥ Command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class IncreaseCountCommand : AbstractCommand</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protected override void OnExecute()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.GetModel&lt;ICounterAppModel&gt;().Count.Value++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class DecreaseCountCommand : AbstractCommand</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protected override void OnExecute()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.GetModel&lt;ICounterAppModel&gt;().Count.Value--;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class CounterAppController : MonoBehaviour,IController // å®ç° IController æ¥å£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // View</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private Button mBtnAdd;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private Button mBtnSub;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private Text mCountText;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private ICounterAppModel Model;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        private void Start()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // è·å–æ¨¡å‹é€šè¿‡æ¥å£</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Model = this.GetModel&lt;ICounterAppModel&gt;(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ç»„ä»¶è·å–</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mBtnAdd = transform.Find(&quot;BtnAdd&quot;).GetComponent&lt;Button&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mBtnSub = transform.Find(&quot;BtnSub&quot;).GetComponent&lt;Button&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mCountText = transform.Find(&quot;CountText&quot;).GetComponent&lt;Text&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ç›‘å¬è¾“å…¥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mBtnAdd.onClick.AddListener(() =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // äº¤äº’é€»è¾‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                this.SendCommand&lt;IncreaseCountCommand&gt;(); // æ²¡æœ‰å‚æ•°æ„é€ çš„å‘½ä»¤æ”¯æŒæ³›å‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mBtnSub.onClick.AddListener(() =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // äº¤äº’é€»è¾‘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                this.SendCommand(new DecreaseCountCommand()); // ä¹Ÿæ”¯æŒç›´æ¥ä¼ å…¥å¯¹è±¡ï¼ˆæ–¹ä¾¿é€šè¿‡æ„é€ ä¼ å‚)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // æ•°æ®å˜æ›´äº‹ä»¶ç›‘å¬</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Model.Count.RegisterWithInitValue(count =&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                mCountText.text = count.ToString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }).UnRegisterWhenGameObjectDestroyed(gameObject);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// æŒ‡å®šæ¶æ„</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        /// &lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public IArchitecture GetArchitecture()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return CounterApp.Interface;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>æ‰€æœ‰çš„æ¨¡å—æ³¨å†Œï¼Œæ¨¡å—è·å– ç­‰ä»£ç éƒ½æ˜¯é€šè¿‡æ¥å£å®Œæˆï¼Œè¿™ä¸€ç‚¹ç¬¦åˆ SOLID åŸåˆ™ä¸­çš„ ä¾èµ–å€’ç½®åŸåˆ™ã€‚</p><p>é€šè¿‡æ¥å£è®¾è®¡æ¨¡å—å¯ä»¥è®©æˆ‘ä»¬æ›´å®¹æ˜“å»æ€è€ƒå…³æ³¨ä¹‹é—´çš„äº¤äº’å’ŒèŒè´£æœ¬èº«ï¼Œè€Œä¸æ˜¯å…·ä½“å®ç°ï¼Œåœ¨è®¾è®¡çš„æ—¶å€™å¯ä»¥å‡å°‘å¾ˆå¤šçš„å¹²æ‰°ã€‚</p><p>å½“ç„¶é¢å‘æ¥å£çš„æ–¹å¼å»åšå¼€å‘ä¹Ÿæœ‰å¾ˆå¤šå…¶ä»–çš„å¥½å¤„ï¼Œè¿™å½“ç„¶æ˜¯å¤§å®¶éšç€ä½¿ç”¨æ—¶é•¿ä¼šæ…¢æ…¢ä½“ä¼šçš„ã€‚</p><p>å…¶ä¸­æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸€ç‚¹ï¼Œå°±æ˜¯æˆ‘ä»¬ä¹‹å‰è¯´çš„ Storageï¼Œå¦‚æœæƒ³æŠŠå­˜å‚¨çš„ API ä» PlayerPrefs åˆ‡æ¢æˆ EasySaveï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸éœ€è¦å»ä¿®æ”¹ Storage å¯¹è±¡ï¼Œè€Œæ˜¯æ‰©å±•ä¸€ä¸ª IStorage æ¥å£å³å¯ï¼Œ ä»£ç å¦‚ä¸‹:</p><div class="codeBlockContainer_J+bg language-csharp theme-code-block"><div class="codeBlockContent_csEI csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">    public class EasySaveStorage : IStorage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public void SaveInt(string key, int value)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // todo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public int LoadInt(string key, int defaultValue = 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // todo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new System.NotImplementedException();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>ç„¶ååœ¨æ³¨å†Œä»£ç æ”¹æˆå¦‚ä¸‹:</p><div class="codeBlockContainer_J+bg language-C# theme-code-block"><div class="codeBlockContent_csEI C#"><pre tabindex="0" class="prism-code language-C# codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">    // å®šä¹‰ä¸€ä¸ªæ¶æ„ï¼ˆç”¨äºç®¡ç†æ¨¡å—ï¼‰</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public class CounterApp : Architecture&lt;CounterApp&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protected override void Init()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // æ³¨å†Œæˆå°±ç³»ç»Ÿ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.RegisterSystem&lt;IAchievementSystem&gt;(new AchievementSystem());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.RegisterModel&lt;ICounterAppModel&gt;(new CounterAppModel());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // æ³¨å†Œå­˜å‚¨å·¥å…·å¯¹è±¡</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // this.RegisterUtility&lt;IStorage&gt;(new Storage());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            this.RegisterUtility&lt;IStorage&gt;(new EasySaveStorage());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>è¿™æ ·ï¼Œåº•å±‚æ‰€æœ‰å­˜å‚¨çš„ä»£ç éƒ½åˆ‡æ¢æˆäº† EasySave çš„å­˜å‚¨ï¼Œæ›¿æ¢ä¸€å¥—æ–¹æ¡ˆéå¸¸ç®€å•ã€‚</p><p>è€Œä¸” Modelã€System éƒ½æ”¯æŒäº†é¢å‘æ¥å£çš„æ–¹å¼è®¾è®¡æ¨¡å—ã€‚</p><p>OKï¼Œåˆ°æ­¤ï¼ŒQFramework æä¾›çš„æ‰€æœ‰çš„å¿…å¤‡æ¦‚å¿µæˆ‘ä»¬éƒ½æ¥è§¦åˆ°äº†ã€‚</p><p>è¿˜å‰©ä¸‹æœ€åä¸€ä¸ªå¯ç”¨å¯ä¸ç”¨çš„æ¦‚å¿µ Queryã€‚</p><p>å¯¹äº Query è¿™é‡Œç¬”è€…ç®€å•è¯´ä¸€å˜´ã€‚</p><p>é¦–å…ˆè¡¨ç°é€»è¾‘æ›´å¤šæ˜¯æ¥æ”¶åˆ°æ•°æ®å˜æ›´äº‹ä»¶ä¹‹åï¼Œå¯¹ Model æˆ–è€… System è¿›è¡ŒæŸ¥è¯¢ï¼Œè€Œä¸”æŸ¥è¯¢çš„æ—¶å€™éœ€è¦ç»„åˆæŸ¥è¯¢ï¼Œæ¯”å¦‚å¤šä¸ª Model ä¸€èµ·æŸ¥è¯¢ï¼ŒæŸ¥è¯¢çš„æ•°æ®è¿˜éœ€è¦åœ¨å¤„ç†ä¸€ä¸‹ï¼Œè¿™ç§æŸ¥è¯¢çš„ä»£ç é‡æ¯”è¾ƒå¤šã€‚è¿™éƒ¨åˆ†ä»£ç æœ‰çš„é¡¹ç›®ä¼šéå¸¸å¤šï¼Œå°¤å…¶æ˜¯åƒæ¨¡æ‹Ÿç»è¥æˆ–è€…éå¸¸é‡æ•°æ®çš„é¡¹ç›®ï¼Œæ‰€ä»¥ QFramework æ”¯æŒ Query è¿™æ ·çš„ä¸€ä¸ªæ¦‚å¿µï¼Œæ¥è§£å†³è¿™é—®é¢˜ã€‚</p><p>å…¶ä½¿ç”¨æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼Œå’Œ Command ç”¨æ³•ä¸€è‡´ï¼Œä»£ç å¦‚ä¸‹:</p><div class="codeBlockContainer_J+bg language-csharp theme-code-block"><div class="codeBlockContent_csEI csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">    public class FiveTimesCountQuery : AbstractQuery&lt;int&gt; // int æ˜¯è¿”å›å€¼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        protected override int OnDo()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return this.GetModel&lt;ICounterAppModel&gt;().Count.Value * 5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>åœ¨ Controller ä¸­çš„è°ƒç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p><div class="codeBlockContainer_J+bg language-csharp theme-code-block"><div class="codeBlockContent_csEI csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">int result = this.SendQuery(new FiveTimesCountQuery());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Debug.Log(result);</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>ä»£ç ä¸éš¾ã€‚</p><p>OKï¼Œåˆ°æ­¤ï¼ŒQFramework å…¨éƒ¨æ¦‚å¿µæˆ‘ä»¬éƒ½æ¥è§¦åˆ°äº†ã€‚</p><p>æœ€åç»™ä¸€å¼ ç¬”è€…äº²è‡ªç”»çš„ç¤ºæ„å›¾ï¼Œæ¥ä½œä¸ºå…¥é—¨æ•™ç¨‹çš„ç»“å°¾ï¼Œå¦‚ä¸‹:</p><p><img src="https://file.liangxiegame.com/1c37eba6-b448-4b27-aaeb-7841652b2f8d.png"></p><p>å•¥éƒ½ä¸è¯´äº†éƒ½åœ¨å›¾é‡Œäº†ã€‚</p><p>å…¥é—¨æ•™ç¨‹å°±åˆ°è¿™é‡Œï¼Œåè¾¹è¿˜ä¼šé™†ç»­æ›´æ–°ä¸€äº›è®ºè¿°æ€§çš„æ–‡ç« ï¼Œæ¥å¸®å¤§å®¶ç†æ¸…æ¦‚å¿µã€‚</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/quick-start/7. rules_bindableproperty_dip.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/quick-start/system"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">6. å¼•å…¥ System</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/more/framework_design"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">QFramework æ˜¯å¦‚ä½•è®¾è®¡å‡ºæ¥çš„?</div></a></div></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="http://shang.qq.com/wpa/qunwpa?idkey=706b8eef0fff3fe4be9ce27c8702ad7d8cc1bceabe3b7c0430ec9559b3a9ce66" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>QQ ç¾¤/QQ Group<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/liangxiegame/QFramework/issues/new" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>github issue<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://gitee.com/liangxiegame/QFramework/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>gitee issue<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/liangxiegame/qframework" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 liangxiegame, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.0f8f5c73.js"></script>
<script src="/assets/js/main.9af385a4.js"></script>
</body>
</html>